import{r,j as e,u as B,b as T}from"./index-h_fRO0Hs.js";import{e as $,f as W}from"./index-DB1yuH0Y.js";import{l as Y}from"./LOGO-AyNIh5tx.js";import{t as L}from"./thankYou-MBrqQPpq.js";import{X as y}from"./x-ChJIMCMG.js";import{a as V,c as w,C as z,I as G}from"./confetti.module-ClXJRI-e.js";import{E as M}from"./expand-l5sHO6nb.js";import"./iconBase-CQKhOVdj.js";import"./createLucideIcon-BdoxpPWD.js";const J=({onClose:o,selectedOption:m,CorrectOption:l,detail:c})=>{const[n,h]=r.useState(!1);return r.useEffect(()=>{h(!0)},[]),e.jsxs(e.Fragment,{children:[e.jsx("style",{children:`
        @keyframes scaleIn {
          0% { transform: scale(0.9); opacity: 0; }
          100% { transform: scale(1); opacity: 1; }
        }
        @keyframes shake {
          0%, 100% { transform: translateX(0); }
          20% { transform: translateX(-6px); }
          40% { transform: translateX(6px); }
          60% { transform: translateX(-4px); }
          80% { transform: translateX(4px); }
        }
        @keyframes bgRedPulse {
          0%, 100% { background-color: rgba(0,0,0,0.6); }
          50% { background-color: rgba(220,38,38,0.7); }
        }
        .animate-wrong {
          animation: scaleIn 0.3s ease-out,
                     shake 0.5s ease-in-out 0.3s;
        }
        .bg-red-pulse {
          animation: bgRedPulse 1.2s ease-in-out forwards;
        }
      `}),e.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50 p-4 font-Outfit bg-black/60 bg-red-pulse",children:e.jsxs("div",{className:`relative w-full max-w-md bg-white rounded-xl shadow-2xl border border-gray-200 p-6 ${n?"animate-wrong":""}`,children:[e.jsx("button",{onClick:()=>o(!1),"aria-label":"Close",className:"absolute cursor-pointer top-4 right-4 p-2 rounded-md text-gray-400 hover:text-gray-600 transition",children:e.jsx(y,{size:20})}),e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx(V,{className:"text-red-600",size:72,strokeWidth:2.5})}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-900 text-center mb-2",children:"Wrong Answer"}),e.jsx("p",{className:"text-gray-600 text-center mb-6",children:"Your selected answer is incorrect."}),e.jsx("div",{className:"p-4 rounded-lg border border-red-200 bg-red-50 mb-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-9 w-9 items-center justify-center rounded-md bg-red-100",children:e.jsx(y,{size:20,className:"text-red-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Your answer"}),e.jsx("div",{className:"text-sm font-medium text-gray-900",children:m})]})]})}),e.jsxs("div",{className:"bg-gray-50 rounded-md border border-gray-200 p-4 text-sm text-gray-700 mb-6",children:[e.jsxs("div",{className:"font-bold text-base text-green-800 mb-1",children:["Correct Option : ",l]}),e.jsx("p",{className:"leading-relaxed",children:c||"Nothing Provided By Admin!"})]}),e.jsx("button",{onClick:()=>o(!1),className:"w-full cursor-pointer bg-red-600 text-white font-semibold py-3 rounded-lg hover:bg-red-700 transition",children:"Better Luck, Next time!"})]})})]})},U=()=>{const m=Date.now()+300,l=["#4CAF50","#81C784","#A5D6A7","#C8E6C9","#B2DFDB","#E6EE9C"],c=()=>{Date.now()>m||(w({particleCount:10,angle:60,spread:100,startVelocity:80,origin:{x:.7,y:1},colors:l,shapes:["circle","square"],scalar:1.2}),w({particleCount:10,angle:120,spread:100,startVelocity:80,origin:{x:.3,y:1},colors:l,shapes:["circle","square"],scalar:1.2}),w({particleCount:10,angle:90,spread:100,startVelocity:80,origin:{x:.5,y:1},colors:l,shapes:["circle","square"],scalar:1.2}),requestAnimationFrame(c))};c()},H=({selectedOption:o,detail:m,onClose:l,showConfetti:c=!0})=>(r.useEffect(()=>{c&&U()},[c]),e.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4 font-Outfit",children:e.jsxs("div",{className:"relative w-full max-w-md bg-white rounded-xl shadow-2xl border border-gray-200 p-6",children:[e.jsx("button",{onClick:()=>l(!1),"aria-label":"Close",className:"absolute cursor-pointer top-4 right-4 p-2 rounded-md text-gray-400 hover:text-gray-600 transition",children:e.jsx(y,{size:20})}),e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx(z,{className:"text-emerald-600",size:72,strokeWidth:2.5})}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-900 text-center mb-2",children:"Correct Answer!"}),e.jsx("p",{className:"text-gray-600 text-center mb-6",children:"Well done â€” you selected the right option."}),e.jsx("div",{className:"p-4 rounded-lg border border-emerald-200 bg-emerald-50 mb-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-9 w-9 items-center justify-center rounded-md bg-emerald-100",children:e.jsx(z,{size:20,className:"text-emerald-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Correct answer"}),e.jsx("div",{className:"text-sm font-medium text-gray-900",children:o.text})]})]})}),e.jsxs("div",{className:"bg-gray-50 rounded-md border border-gray-200 p-4 text-sm text-gray-700 mb-6",children:[e.jsx("div",{className:"font-medium text-gray-800 mb-1",children:"Why this is correct"}),e.jsx("p",{className:"leading-relaxed",children:m||"Nothing Provided by Admin!"})]}),e.jsx("button",{onClick:()=>l(!1),className:"w-full cursor-pointer bg-emerald-600 text-white font-semibold py-3 rounded-lg hover:bg-emerald-700 transition",children:"Continue"})]})})),ae=()=>{const[o,m]=r.useState([]),{userId:l}=B(),{presentationId:c}=T(),[n,h]=r.useState(null),[x,g]=r.useState(0),[P,b]=r.useState(!1),[E,j]=r.useState(!1),[f,N]=r.useState({isCorrect:!1,selectedOption:"",correctOption:"",description:"",selectedOptionObj:null}),[F,p]=r.useState(!1),[v,C]=r.useState(!1),[Q,O]=r.useState(!1),[k,I]=r.useState(!1),S=r.useRef(null),A=o.length>0?o.every(t=>t.attempted?.attempted===!0):!1,q=async(t,s)=>{if(t.attempted?.attempted===!0)return;const d=t.options.find(i=>i.answer===!0),a=s.answer===!0;m(i=>i.map(u=>u._id===t._id?{...u,attempted:{attempted:!0,optionId:s._id,timeStamp:new Date().toISOString()}}:u)),N({isCorrect:a,selectedOption:s.text,correctOption:d.text,description:t.description,selectedOptionObj:s}),a?(O(!0),b(!0)):j(!0);try{(await fetch("https://quizidy-backend.duckdns.org/AIFeatures/SubmitAnswerForAIPoweredQuiz",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({presentationId:c,userId:l,questionId:t._id,selectedOptionId:s._id})})).ok?console.log("Answer submitted successfully"):console.error("Failed to submit answer to backend")}catch(i){console.error("Error submitting answer:",i)}},_=()=>{x<o.length-1&&g(x+1)},D=()=>{x>0&&g(x-1)},R=()=>{const t=S.current;t&&t.requestFullscreen&&t.requestFullscreen().catch(s=>{console.warn("Fullscreen request failed:",s)})},X=async()=>{try{p(!0);const t=await fetch(`https://quizidy-backend.duckdns.org/AIFeatures/GetQuestionsForAIPoweredQuiz/${c}/${l}`);if(!t.ok){console.error("Failed to fetch questions"),p(!1);return}const s=await t.json();console.log("Fetched questions:",s);const d=s.questions||[];m(d);const a=d.findIndex(u=>u.attempted?.attempted!==!0),i=a!==-1?a:0;g(i),h(d[i]||null),p(!1)}catch(t){console.error("Error while fetching questions:",t),p(!1)}};return r.useEffect(()=>{X()},[]),r.useEffect(()=>{if(o.length>0){const t=Math.min(Math.max(x,0),o.length-1);h(o[t]),A&&!k&&I(!0)}},[o,x,A]),F?e.jsx("div",{className:"w-screen h-screen bg-white flex justify-center items-center fixed top-0 left-0 z-10 ",children:e.jsxs("div",{className:"flex justify-center items-center flex-col gap-2",children:[e.jsx("div",{className:"h-10 w-10 border-4 border-gray-200 border-t-indigo-500 rounded-full animate-spin"}),e.jsx("div",{className:"font-Outfit flex justify-center items-center",children:e.jsx("h1",{children:"Building up your Quiz."})})]})}):e.jsxs("div",{ref:S,className:"w-screen overflow-hidden h-screen relative flex",children:[e.jsxs("div",{className:`w-full h-full flex flex-col gap-5 justify-center ${n?.designTemplate||"bg-BG-3"} items-center bg-cover bg-center bg-no-repeat`,children:[e.jsx("div",{children:e.jsx("img",{src:Y,className:"w-48",alt:"Logo"})}),e.jsxs("div",{className:"flex flex-col gap-6 w-full justify-center items-center",children:[e.jsxs("div",{className:"font-Outfit  w-full flex justify-center items-center pl-5 pr-5 text-center text-2xl",children:["Q) ",n?.question||""]}),e.jsxs("div",{className:"flex w-[90%] sm:w-[80%] md:w-[40%] flex-col justify-center items-center gap-4 px-4 sm:px-8",children:[!n?.options?.length&&e.jsx("div",{className:"text-stone-700 font-Outfit",children:"No options available for this question."}),(n?.options||[]).map((t,s)=>{const d=n.attempted?.attempted===!0&&t._id===n.attempted?.optionId,a=t.answer===!0,i=n.attempted?.attempted===!0;let u="bg-stone-900";return i&&(d?u=a?"bg-green-400":"bg-red-600":a?u="bg-green-400":u="bg-stone-700"),e.jsx("div",{className:`h-16 w-[80%] cursor-pointer text-white font-Outfit flex items-center px-4 rounded-xl transition-all duration-300 hover:scale-[1.01] ${u} ${i&&!d?"cursor-not-allowed":""}`,onClick:()=>!i&&q(n,t),children:e.jsx("span",{className:"w-full text-sm sm:text-base md:text-lg",children:t.text})},t._id||s)})]}),n?.attempted?.attempted===!0&&e.jsxs("div",{className:"flex gap-3 items-center flex-wrap justify-center",children:[e.jsx("div",{className:"bg-indigo-400 text-white font-Outfit rounded-md px-4 py-2 shadow-sm",children:"Already Attempted"}),e.jsx("button",{onClick:()=>{const t=n.options.find(a=>a.answer===!0),s=n.options.find(a=>a._id===n.attempted?.optionId),d=s?.answer===!0;N({isCorrect:d,selectedOption:s?.text||"",correctOption:t?.text||"",description:n.description,selectedOptionObj:s}),O(!1),d?b(!0):j(!0)},className:"bg-emerald-500 hover:bg-emerald-600 text-white font-Outfit rounded-md px-4 py-2 shadow-sm transition-colors",children:"View Explanation"})]}),e.jsx("div",{className:"w-full mt-4 flex flex-col justify-center items-center gap-4",children:e.jsxs("div",{className:"w-full flex gap-4 justify-center items-center",children:[e.jsx("div",{children:e.jsxs("button",{className:"font-Outfit flex justify-center items-center gap-2 text-lg h-10 w-40 rounded-2xl bg-black hover:scale-110 transition-all ease-in-out duration-100 cursor-pointer text-white",onClick:D,children:[e.jsx($,{}),"Previous"]})}),e.jsx("div",{children:e.jsxs("button",{className:"font-Outfit flex justify-center items-center gap-2 text-lg h-10 w-40 rounded-2xl bg-black hover:scale-110 transition-all ease-in-out duration-100 cursor-pointer text-white",onClick:_,children:["Next ",e.jsx(W,{})]})})]})})]})]}),e.jsx("div",{className:"fixed bottom-6 right-[96px] md:bottom-8 md:right-[96px] cursor-pointer p-3 border border-stone-300 rounded-full bg-stone-900 z-10 shadow-md",onClick:R,children:e.jsx(M,{color:"white"})}),e.jsx("div",{className:"fixed bottom-6 right-10 md:bottom-8 md:right-10 cursor-pointer p-3 border border-stone-300 rounded-full bg-stone-900 z-10 shadow-md",onClick:()=>C(!v),children:e.jsx(G,{color:"white"})}),k&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex justify-center items-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 flex flex-col items-center gap-6 max-w-md mx-4",children:[e.jsx("img",{src:L,alt:"Thank You",className:"w-32 h-32 object-contain animate-bounce"}),e.jsx("h2",{className:"text-2xl md:text-3xl font-Outfit font-bold text-center text-stone-800",children:"You have Completed the Quiz!"}),e.jsx("p",{className:"text-stone-600 text-sm text-center font-Outfit",children:"Thanks for using Quizify! You can continue reviewing your answers or close this message."}),e.jsx("button",{onClick:()=>I(!1),className:"px-6 py-2 bg-indigo-500 hover:bg-indigo-600 text-white rounded-lg transition-all duration-200 font-Outfit",children:"Continue Reviewing"})]})}),v&&e.jsxs("div",{className:"fixed font-Outfit top-20 right-10 bg-white rounded-lg shadow-lg p-4 w-80 z-50 border border-stone-200",children:[e.jsx("h3",{className:"font-Outfit font-semibold text-stone-800 mb-2",children:"Quiz Information"}),e.jsx("p",{className:"text-sm text-stone-600 font-Outfit",children:"This is a AI Powered Quiz. Answer all questions by selecting an option. Once submitted, you cannot change your answer. Use Next/Previous to navigate between questions."}),e.jsx("button",{onClick:()=>C(!1),className:"mt-3 bg-indigo-500 hover:bg-indigo-600 text-white px-4 py-1 rounded-md text-sm",children:"Close"})]}),P&&e.jsx(H,{onClose:b,selectedOption:f.selectedOptionObj||{text:f.selectedOption},detail:f.description,showConfetti:Q}),E&&e.jsx(J,{onClose:j,selectedOption:f.selectedOption,CorrectOption:f.correctOption,detail:f.description})]})};export{ae as default};
